-#ifndef CONFIG_SPARSE_IRQ
+#ifdef CONFIG_SPARSE_IRQ
+  extern void irq_lock_sparse(void);
+  extern void irq_unlock_sparse(void);
+#else
+  static inline void irq_lock_sparse(void) { }
+  static inline void irq_unlock_sparse(void) { }
   extern struct irq_desc irq_desc[NR_IRQS];
 #endif
